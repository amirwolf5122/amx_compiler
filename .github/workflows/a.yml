name: run

on: workflow_dispatch
jobs:
  build_and_release:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set up Git
      run: git config --global user.name "Your Name" && git config --global user.email "your.email@example.com"

    - name: Install dependencies (optional)
      run: |
        sudo apt-get update
        sudo apt-get install zip  # نصب بسته zip در صورت نیاز

    - name: Run compile.sh and zip the compiled files
      run: |
        cd scripting
        chmod +x *
        ./compile.sh
        zip -r compiled.zip compiled/  # فقط فایل‌ها درون پوشه compiled را فشرده می‌کنیم

    - name: Upload the zip file as an artifact
      uses: actions/upload-artifact@v2
      with:
        name: compiled-files  # نام artifact که آپلود می‌شود
        path: scripting/compiled.zip  # مسیر فایل زیپ شده که باید آپلود شود

    - name: Create Release and upload compiled.zip
      uses: ncipollo/release-action@v1
      with:
        files: scripting/compiled.zip  # آپلود فایل زیپ به عنوان Release Asset
        tag: v1  # یا نام دیگری برای برچسب نسخه
